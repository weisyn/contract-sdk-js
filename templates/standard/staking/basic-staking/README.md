# åŸºç¡€è´¨æŠ¼åˆçº¦ç¤ºä¾‹

**åˆ†ç±»**: Staking è´¨æŠ¼ç¤ºä¾‹  
**éš¾åº¦**: â­â­â­ é«˜çº§  
**æœ€åæ›´æ–°**: 2025-11-23

---

## ğŸ“‹ æ¦‚è¿°

æœ¬ç¤ºä¾‹å±•ç¤ºå¦‚ä½•ä½¿ç”¨ WES Contract SDK JS æ„å»ºè´¨æŠ¼å’Œå§”æ‰˜ç›¸å…³çš„æ™ºèƒ½åˆçº¦ã€‚é€šè¿‡æœ¬ç¤ºä¾‹ï¼Œæ‚¨å¯ä»¥å­¦ä¹ å¦‚ä½•ä½¿ç”¨ `helpers/staking` æ¨¡å—æä¾›çš„ä¸šåŠ¡è¯­ä¹‰APIï¼Œç®€åŒ–è´¨æŠ¼åˆçº¦çš„å¼€å‘ã€‚

---

## ğŸ¯ æ ¸å¿ƒåŠŸèƒ½

æœ¬ç¤ºä¾‹å®ç°äº†å®Œæ•´çš„è´¨æŠ¼å’Œå§”æ‰˜åŠŸèƒ½ï¼š

| åŠŸèƒ½ | å‡½æ•° | è¯´æ˜ |
|------|------|------|
| âœ… **è´¨æŠ¼** | `Stake` | ä»£å¸è´¨æŠ¼ï¼Œè‡ªåŠ¨å¤„ç†ä½™é¢æ£€æŸ¥å’Œäº¤æ˜“æ„å»º |
| âœ… **è§£è´¨æŠ¼** | `Unstake` | è§£è´¨æŠ¼ä»£å¸ï¼Œæ”¯æŒéƒ¨åˆ†æˆ–å…¨éƒ¨è§£è´¨æŠ¼ |
| âœ… **å§”æ‰˜** | `Delegate` | å°†è´¨æŠ¼æƒå§”æ‰˜ç»™éªŒè¯è€… |
| âœ… **å–æ¶ˆå§”æ‰˜** | `Undelegate` | å–æ¶ˆå§”æ‰˜ï¼Œæ”¯æŒéƒ¨åˆ†æˆ–å…¨éƒ¨å–æ¶ˆå§”æ‰˜ |

---

## ğŸ—ï¸ æ¶æ„è®¾è®¡

```mermaid
graph TB
    A[åˆçº¦è°ƒç”¨è€…] -->|è°ƒç”¨å‡½æ•°| B[åˆçº¦å‡½æ•°]
    B -->|ä½¿ç”¨| C[helpers/staking]
    C -->|è°ƒç”¨| D[frameworkå±‚]
    D -->|HostABI| E[WESèŠ‚ç‚¹]
    
    C -->|è‡ªåŠ¨å¤„ç†| F[ä½™é¢æ£€æŸ¥]
    C -->|è‡ªåŠ¨å¤„ç†| G[äº¤æ˜“æ„å»º]
    C -->|è‡ªåŠ¨å¤„ç†| H[äº‹ä»¶å‘å‡º]
    
    style C fill:#e1f5ff
    style D fill:#fff4e1
    style E fill:#ffe1f5
```

**æ¶æ„è¯´æ˜**ï¼š
- **åˆçº¦å±‚**ï¼šå¼€å‘è€…ç¼–å†™çš„åˆçº¦å‡½æ•°
- **Helperså±‚**ï¼šä¸šåŠ¡è¯­ä¹‰APIï¼Œè‡ªåŠ¨å¤„ç†ä½™é¢æ£€æŸ¥ã€äº¤æ˜“æ„å»ºã€äº‹ä»¶å‘å‡º
- **Frameworkå±‚**ï¼šHostABIå°è£…ï¼Œæä¾›åŸºç¡€åŸè¯­
- **èŠ‚ç‚¹å±‚**ï¼šWESèŠ‚ç‚¹ï¼Œæ‰§è¡Œåˆçº¦å¹¶ä¸Šé“¾

---

## ğŸ“š åŠŸèƒ½è¯¦è§£

### 1. Stake - è´¨æŠ¼

**åŠŸèƒ½è¯´æ˜**ï¼šä½¿ç”¨ `staking.Stake()` è¿›è¡Œä»£å¸è´¨æŠ¼ã€‚

**å‚æ•°æ ¼å¼**ï¼š
```json
{
  "validator": "Cf1Kes6snEUeykiJJgrAtKPNPrAzPdPmSn",
  "amount": 10000
}
```

**SDKè‡ªåŠ¨å¤„ç†**ï¼š
- âœ… ä½™é¢æ£€æŸ¥ï¼ˆç¡®ä¿è´¨æŠ¼è€…ä½™é¢å……è¶³ï¼‰
- âœ… äº¤æ˜“æ„å»ºï¼ˆè‡ªåŠ¨æ„å»º UTXO äº¤æ˜“ï¼‰
- âœ… äº‹ä»¶å‘å‡ºï¼ˆè‡ªåŠ¨å‘å‡º Stake äº‹ä»¶ï¼‰

**âš ï¸ æ³¨æ„**ï¼šå®é™…åº”ç”¨ä¸­éœ€è¦ä¸šåŠ¡è§„åˆ™æ£€æŸ¥
- éªŒè¯è€…æœ‰æ•ˆæ€§æ£€æŸ¥ï¼ˆéªŒè¯è€…æ˜¯å¦åœ¨éªŒè¯è€…åˆ—è¡¨ä¸­ï¼‰
- æœ€å°è´¨æŠ¼æ•°é‡æ£€æŸ¥
- é”å®šæœŸæ£€æŸ¥ï¼ˆä¸šåŠ¡é€»è¾‘ï¼‰

**ä½¿ç”¨ç¤ºä¾‹**ï¼š
```bash
wes contract call --address {contract_addr} \
  --function Stake \
  --params '{"validator":"Cf1Kes6snEUeykiJJgrAtKPNPrAzPdPmSn","amount":10000}'
```

---

### 2. Unstake - è§£è´¨æŠ¼

**åŠŸèƒ½è¯´æ˜**ï¼šä½¿ç”¨ `staking.Unstake()` è§£è´¨æŠ¼ä»£å¸ã€‚

**å‚æ•°æ ¼å¼**ï¼š
```json
{
  "validator": "Cf1Kes6snEUeykiJJgrAtKPNPrAzPdPmSn",
  "amount": 5000
}
```

**SDKè‡ªåŠ¨å¤„ç†**ï¼š
- âœ… è´¨æŠ¼ä½™é¢æ£€æŸ¥ï¼ˆç¡®ä¿æœ‰è¶³å¤Ÿçš„è´¨æŠ¼ä½™é¢ï¼‰
- âœ… äº¤æ˜“æ„å»ºï¼ˆè‡ªåŠ¨æ„å»º UTXO äº¤æ˜“ï¼‰
- âœ… äº‹ä»¶å‘å‡ºï¼ˆè‡ªåŠ¨å‘å‡º Unstake äº‹ä»¶ï¼‰

**âš ï¸ æ³¨æ„**ï¼šå®é™…åº”ç”¨ä¸­éœ€è¦ä¸šåŠ¡è§„åˆ™æ£€æŸ¥
- é”å®šæœŸæ£€æŸ¥ï¼ˆæ˜¯å¦æ»¡è¶³è§£é”æ¡ä»¶ï¼‰
- è§£è´¨æŠ¼å†·å´æœŸæ£€æŸ¥

**ä½¿ç”¨ç¤ºä¾‹**ï¼š
```bash
wes contract call --address {contract_addr} \
  --function Unstake \
  --params '{"validator":"Cf1Kes6snEUeykiJJgrAtKPNPrAzPdPmSn","amount":5000}'
```

---

### 3. Delegate - å§”æ‰˜è´¨æŠ¼

**åŠŸèƒ½è¯´æ˜**ï¼šä½¿ç”¨ `staking.Delegate()` å°†è´¨æŠ¼æƒå§”æ‰˜ç»™éªŒè¯è€…ã€‚

**å‚æ•°æ ¼å¼**ï¼š
```json
{
  "validator": "Cf1Kes6snEUeykiJJgrAtKPNPrAzPdPmSn",
  "amount": 5000
}
```

**ä½¿ç”¨ç¤ºä¾‹**ï¼š
```bash
wes contract call --address {contract_addr} \
  --function Delegate \
  --params '{"validator":"Cf1Kes6snEUeykiJJgrAtKPNPrAzPdPmSn","amount":5000}'
```

---

### 4. Undelegate - å–æ¶ˆå§”æ‰˜

**åŠŸèƒ½è¯´æ˜**ï¼šä½¿ç”¨ `staking.Undelegate()` å–æ¶ˆå§”æ‰˜ã€‚

**å‚æ•°æ ¼å¼**ï¼š
```json
{
  "validator": "Cf1Kes6snEUeykiJJgrAtKPNPrAzPdPmSn",
  "amount": 5000
}
```

**ä½¿ç”¨ç¤ºä¾‹**ï¼š
```bash
wes contract call --address {contract_addr} \
  --function Undelegate \
  --params '{"validator":"Cf1Kes6snEUeykiJJgrAtKPNPrAzPdPmSn","amount":5000}'
```

---

## ğŸš€ å¿«é€Ÿå¼€å§‹

### 1. ç¼–è¯‘åˆçº¦

```bash
cd templates/standard/staking/basic-staking
asc contract.ts --target release --outFile contract.wasm
```

### 2. éƒ¨ç½²åˆçº¦

```bash
wes contract deploy --wasm contract.wasm --function Initialize
```

### 3. è°ƒç”¨åˆçº¦

```bash
# è´¨æŠ¼ä»£å¸
wes contract call --address {contract_addr} \
  --function Stake \
  --params '{"validator":"Cf1Kes6snEUeykiJJgrAtKPNPrAzPdPmSn","amount":10000}'

# è§£è´¨æŠ¼ä»£å¸
wes contract call --address {contract_addr} \
  --function Unstake \
  --params '{"validator":"Cf1Kes6snEUeykiJJgrAtKPNPrAzPdPmSn","amount":5000}'
```

---

## ğŸ“Š SDK vs åº”ç”¨å±‚èŒè´£

| èŒè´£ | SDK æä¾› | åº”ç”¨å±‚å®ç° |
|------|---------|-----------|
| **è´¨æŠ¼æ“ä½œ** | âœ… è‡ªåŠ¨å¤„ç† | - |
| **è§£è´¨æŠ¼æ“ä½œ** | âœ… è‡ªåŠ¨å¤„ç† | - |
| **å§”æ‰˜æ“ä½œ** | âœ… è‡ªåŠ¨å¤„ç† | - |
| **éªŒè¯è€…æœ‰æ•ˆæ€§** | âŒ | âœ… éœ€è¦å®ç° |
| **æœ€å°è´¨æŠ¼æ•°é‡** | âŒ | âœ… éœ€è¦å®ç° |
| **é”å®šæœŸæ£€æŸ¥** | âŒ | âœ… éœ€è¦å®ç° |
| **è§£è´¨æŠ¼å†·å´æœŸ** | âŒ | âœ… éœ€è¦å®ç° |

---

## ğŸ’¡ è®¾è®¡ç†å¿µ

### è´¨æŠ¼ vs å§”æ‰˜

| ç‰¹æ€§ | è´¨æŠ¼ | å§”æ‰˜ |
|------|------|------|
| **æ“ä½œå¯¹è±¡** | éªŒè¯è€… | éªŒè¯è€… |
| **æ‰€æœ‰æƒ** | è´¨æŠ¼è€…æŒæœ‰ | å§”æ‰˜è€…æŒæœ‰ |
| **æ”¶ç›Šåˆ†é…** | è´¨æŠ¼è€…è·å¾— | å§”æ‰˜è€…å’ŒéªŒè¯è€…åˆ†é… |
| **ç”¨é€”** | ç›´æ¥å‚ä¸éªŒè¯ | é—´æ¥å‚ä¸éªŒè¯ |

### SDK æä¾›"ç§¯æœ¨"

SDK æä¾›åŸºç¡€èƒ½åŠ›ï¼ˆStakeã€Unstakeã€Delegateã€Undelegateï¼‰ï¼Œå¼€å‘è€…å¯ä»¥ï¼š

- âœ… ç›´æ¥ä½¿ç”¨åŸºç¡€åŠŸèƒ½åˆ›å»ºè´¨æŠ¼åˆçº¦
- âœ… æ·»åŠ ä¸šåŠ¡è§„åˆ™å®ç°å®šåˆ¶éœ€æ±‚
- âœ… ç»„åˆå¤šä¸ªåŠŸèƒ½å®ç°å¤æ‚åœºæ™¯

### åº”ç”¨å±‚æ­å»º"å»ºç­‘"

åº”ç”¨å±‚åœ¨ SDK åŸºç¡€ä¸Šå®ç°ï¼š

- âœ… éªŒè¯è€…ç®¡ç†ï¼ˆéªŒè¯è€…åˆ—è¡¨ã€æœ‰æ•ˆæ€§æ£€æŸ¥ï¼‰
- âœ… è´¨æŠ¼è§„åˆ™ï¼ˆæœ€å°è´¨æŠ¼æ•°é‡ã€é”å®šæœŸï¼‰
- âœ… æ”¶ç›Šåˆ†é…ï¼ˆè´¨æŠ¼å¥–åŠ±ã€å§”æ‰˜å¥–åŠ±ï¼‰

---

## ğŸ”— ç›¸å…³æ–‡æ¡£

- [Staking Helper æ–‡æ¡£](../../../../docs/API_REFERENCE.md#staking) - Staking æ¨¡å—è¯¦ç»†è¯´æ˜
- [Framework æ–‡æ¡£](../../../../_dev/FRAMEWORK_DESIGN.md) - Framework å±‚è¯´æ˜
- [ç¤ºä¾‹æ€»è§ˆ](../README.md) - æ‰€æœ‰ç¤ºä¾‹ç´¢å¼•

---

**æœ€åæ›´æ–°**: 2025-11-23

